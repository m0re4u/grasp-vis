{% extends "base.html" %}

{% block title %}GRaSP visualizer{% endblock %}

{% block head %} {{ super() }} {% endblock %}

{% block navbar %} {{ super() }} {% endblock %}

{% block content %}
    {{ super() }}
    <div class="row">
      <div class="col-2" id="factuality-container">
        <table class="mh-100 table">
          <thead>
            <tr>
              <th scope="col">Resource</th>
              <th scope="col">Value</th>
            </tr>
          </thead>
          <tbody id="factval-table-body">
          </tbody>
        </table>
      </div>
      <div class="col-md-auto text-end overflow-auto" id="event-container">
        <table class="mh-100 table table-hover" id="events">
          <thead>
            <tr>
              <th scope="col">Event</th>
            </tr>
          </thead>
          <tbody>
          {% for i, e in events %}
            <tr>
              <td class="event-selector" id="{{i}}">{{e}}</td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>
      <div class="col-6">
          <div class="text-center py-5 px-3">
              <p id="text-box">{{ text }}</p>
          </div>
      </div>
      <div class="col"></div>
    </div>

    <script type=text/javascript>
      $(document).on('mouseover mouseout', '.event-selector', function(e) {
        var eid = e.target.id;
        const COLOR = 'rgb(127, 255, 0)';
        if ($('span#' + eid).css('background-color') == COLOR) {
          $('span#' + eid).css('background-color', '');
        } else {
          $('span#' + eid).css('background-color', COLOR);
        }
      });
      $(document).on('click', '.event-selector', function(e) {
        var eid = e.target.id;
        $.getJSON($SCRIPT_ROOT + '/select_event', {
          event_id: eid
        }, function (data) {
          $('#factval-table-body').empty();
          for (let i = 0; i < data.result.length; i++) {
            const element = data.result[i];
            $('#factval-table-body').append("<tr><td>"+element[0]+"</td><td>"+element[1]+"</td></tr>")
          }
        });
      });
    </script>
{% endblock %}

{% block footer %} {{ super() }} {% endblock %}

